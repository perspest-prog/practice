# Технологии проекта

## Основные технологии

- **TypeScript** - язык программирования, используемый для разработки бота
- **Node.js** - среда выполнения JavaScript на стороне сервера
- **Telegraf** (v4.16.3) - фреймворк для создания Telegram ботов

### Telegraf

Telegraf - это современный фреймворк для создания Telegram ботов на Node.js. Он предоставляет удобный API и множество встроенных функций:

- Поддержка middleware
- Встроенная поддержка TypeScript
- Обработка команд, текстовых сообщений, кнопок и других типов взаимодействия
- Поддержка inline-режима
- Работа с файлами и медиа
- Поддержка веб-хуков и long polling

#### Пример базового бота на Telegraf

```typescript
import { Telegraf } from 'telegraf';

// Создаем экземпляр бота с токеном
const bot = new Telegraf(process.env.BOT_TOKEN);

// Обработка команды /start
bot.command('start', (ctx) => {
    ctx.reply('Привет! Я базовый бот на Telegraf.');
});

// Обработка текстовых сообщений
bot.on('text', (ctx) => {
    ctx.reply(`Вы написали: ${ctx.message.text}`);
});

// Обработка нажатия на кнопку
bot.action('button_click', (ctx) => {
    ctx.answerCbQuery('Кнопка нажата!');
    ctx.reply('Вы нажали на кнопку!');
});

// Запуск бота
bot.launch()
    .then(() => console.log('Бот запущен'))
    .catch((err) => console.error('Ошибка запуска бота:', err));
```

## Инструменты разработки

- **nodemon** (v3.1.7) - утилита для автоматической перезагрузки сервера при изменении кода
- **ts-node** (v10.9.2) - утилита для запуска TypeScript кода напрямую
- **TypeScript** (v5.7.2) - компилятор TypeScript
- **@types/node** (v22.15.17) - типы TypeScript для Node.js

## Структура проекта

Проект использует следующую структуру:
- `src/` - исходный код проекта
- `dist/` - скомпилированный JavaScript код

## Скрипты

- `npm run dev` - запуск проекта в режиме разработки с автоматической перезагрузкой
- `npm run build` - компиляция TypeScript в JavaScript
- `npm start` - запуск скомпилированного приложения

## Dockerfile

Dockerfile использует многоэтапную сборку (multi-stage build) для оптимизации размера итогового образа:

1. **Базовый образ**:
   - Использует Node.js версии 18
   - Основан на Alpine Linux 3.21
   - Минимальный размер базового образа

2. **Этап сборки (build stage)**:
   - Копирует все файлы проекта в контейнер
   - Устанавливает зависимости через yarn
   - Компилирует TypeScript код в JavaScript

3. **Этап production**:
   - Использует тот же базовый образ
   - Устанавливает переменную окружения NODE_ENV=production
   - Копирует только необходимые файлы:
     - package.json для установки зависимостей
     - Скомпилированные файлы из этапа сборки
   - Устанавливает только production зависимости
   - Запускает приложение через yarn start

### Преимущества такой конфигурации:
- Минимальный размер итогового образа
- Безопасность (только production зависимости)
- Оптимизированная сборка
- Изоляция этапов сборки и выполнения
